ASSIGNMENT # 3

Name: Sania Arif
Uni: sa3311



***** Question 4: Recurrence Relation and cost function *****

epoch 0:
epoch: 0 batch: 0 cost: 99.6541766281 time: 100.635164022
epoch: 0 batch: 1 cost: 95.0307514344 time: 121.364086866
epoch: 0 batch: 2 cost: 90.2739917794 time: 107.190723896
epoch: 0 batch: 3 cost: 90.163151574 time: 109.488341093
epoch: 0 batch: 4 cost: 109.718442111 time: 89.4928860664
epoch: 0 batch: 5 cost: 117.631604543 time: 116.552023172
epoch: 0 batch: 6 cost: 98.6964961817 time: 102.616393089
epoch: 0 batch: 7 cost: 89.0748442406 time: 81.8627998829
epoch: 0 batch: 8 cost: 88.5862918139 time: 101.843603134
epoch: 0 batch: 9 cost: 79.174998434 time: 103.062988043
epoch: 0 batch: 10 cost: 93.7740070639 time: 116.895140886
...
done with epoch 0, epoch cost = 2488.46854222
(6780, 100)
(472, 100)
train acc = 0.35, val acc = 0.108050847458
Micro Averaged:
0.108050847458
0.108050847458
0.108050847458
Macro Averaged:
0.0756937695713
0.0540351729664
0.0547941627533
----------------------------------------------------------------

epoch 10:
epoch: 10 batch: 0 cost: 30.1295968733 time: 79.586181879
epoch: 10 batch: 1 cost: 24.5783342512 time: 79.3165941238
epoch: 10 batch: 2 cost: 27.3518617244 time: 89.9362440109
epoch: 10 batch: 3 cost: 28.9386973203 time: 96.9438591003
epoch: 10 batch: 4 cost: 39.9472675208 time: 68.0956611633
epoch: 10 batch: 5 cost: 41.054576509 time: 97.5379719734
epoch: 10 batch: 6 cost: 33.5795096168 time: 89.5632941723
epoch: 10 batch: 7 cost: 33.5233078221 time: 77.0701239109
epoch: 10 batch: 8 cost: 42.0777886606 time: 98.1872680187
epoch: 10 batch: 9 cost: 37.836592212 time: 90.6998929977
epoch: 10 batch: 10 cost: 34.5279305054 time: 80.0615439415
...
done with epoch 10, epoch cost = 893.494565298
(6780, 100)
(472, 100)
train acc = 0.981120943953, val acc = 0.358050847458
Micro Averaged:
0.358050847458
0.358050847458
0.358050847458
Macro Averaged:
0.20455568478
0.126297571388
0.145659105428
----------------------------------------------------------------

**NOTE: Adding because I got the required 41% accuracy here
epoch 20:
epoch: 20 batch: 0 cost: 19.9768773918 time: 84.1772260666
epoch: 20 batch: 1 cost: 22.5075206652 time: 82.2404270172
epoch: 20 batch: 2 cost: 27.3232649639 time: 80.0999588966
epoch: 20 batch: 3 cost: 23.6775491889 time: 83.9964220524
epoch: 20 batch: 4 cost: 26.5239399823 time: 72.1793239117
epoch: 20 batch: 5 cost: 28.401322634 time: 87.6118559837
epoch: 20 batch: 6 cost: 24.2350962074 time: 84.2768518925
epoch: 20 batch: 7 cost: 25.7254727671 time: 73.1693980694
epoch: 20 batch: 8 cost: 30.5980111446 time: 82.1424241066
epoch: 20 batch: 9 cost: 29.6414243427 time: 91.5907120705
epoch: 20 batch: 10 cost: 25.8322402281 time: 94.8360700607
...
done with epoch 20, epoch cost = 665.271115078
(6780, 100)
(472, 100)
train acc = 0.996460176991, val acc = 0.411016949153
Micro Averaged:
0.411016949153
0.411016949153
0.411016949153
Macro Averaged:
0.249040528337
0.147314656895
0.173709054677
----------------------------------------------------------------

epoch 25:
epoch: 25 batch: 0 cost: 21.8361153852 time: 65.4686601162
epoch: 25 batch: 1 cost: 18.8418107154 time: 66.4469161034
epoch: 25 batch: 2 cost: 21.7459250326 time: 68.7903559208
epoch: 25 batch: 3 cost: 19.8134404956 time: 72.249778986
epoch: 25 batch: 4 cost: 25.5016090797 time: 62.625921011
epoch: 25 batch: 5 cost: 26.9913014851 time: 67.9405767918
epoch: 25 batch: 6 cost: 22.0016507013 time: 68.9554839134
epoch: 25 batch: 7 cost: 23.5570495795 time: 60.6084492207
epoch: 25 batch: 8 cost: 28.1613620158 time: 66.7259590626
epoch: 25 batch: 9 cost: 26.8074039033 time: 65.8312871456
epoch: 25 batch: 10 cost: 24.621546955 time: 68.1246619225
...
done with epoch 25, epoch cost = 664.470779237
-----------------------------------------------------------------

final answer:
...
done with epoch 29, epoch cost = 616.51385729
(6780, 100)
(472, 100)
train acc = 0.998820058997, val acc = 0.404661016949
Micro Averaged:
0.404661016949
0.404661016949
0.404661016949
Macro Averaged:
0.244943039417
0.146818174131
0.170007977059






****** Question 5: Options for Embeddings  *******


****** a) python main.py --We mymodel --save word2vec_init.npz ******

epoch 0:
epoch: 0 batch: 0 cost: 104.927363001 time: 29.0704381466
epoch: 0 batch: 1 cost: 91.1231656082 time: 31.1176831722
epoch: 0 batch: 2 cost: 87.4052806914 time: 32.1490139961
epoch: 0 batch: 3 cost: 79.1856928579 time: 30.7931540012
epoch: 0 batch: 4 cost: 119.48969014 time: 29.3211369514
epoch: 0 batch: 5 cost: 118.112193232 time: 31.6345620155
epoch: 0 batch: 6 cost: 106.826750757 time: 31.6092939377
epoch: 0 batch: 7 cost: 99.2564122436 time: 24.7520940304
epoch: 0 batch: 8 cost: 109.612966069 time: 27.4076280594
epoch: 0 batch: 9 cost: 96.1908654086 time: 26.9681990147
epoch: 0 batch: 10 cost: 89.3453218434 time: 27.7151157856
...
done with epoch 0, epoch cost = 2413.99437612
(6780, 100)
(472, 100)
train acc = 0.334955752212, val acc = 0.131355932203
Micro Averaged:
0.131355932203
0.131355932203
0.131355932203
Macro Averaged:
0.111529558405
0.0607780134096
0.0672044995951
----------------------------------------------------------------

epoch 10:
epoch: 10 batch: 0 cost: 38.9240213063 time: 25.6391680241
epoch: 10 batch: 1 cost: 34.2322394143 time: 27.2416608334
epoch: 10 batch: 2 cost: 34.5540480867 time: 28.4885489941
epoch: 10 batch: 3 cost: 32.4044670274 time: 27.6169159412
epoch: 10 batch: 4 cost: 51.8411113171 time: 26.0738930702
epoch: 10 batch: 5 cost: 50.7472808277 time: 29.1882288456
epoch: 10 batch: 6 cost: 42.2383496848 time: 30.4896948338
epoch: 10 batch: 7 cost: 43.255930588 time: 28.1355478764
epoch: 10 batch: 8 cost: 51.9973057301 time: 30.9560699463
epoch: 10 batch: 9 cost: 48.0694400491 time: 31.2047390938
epoch: 10 batch: 10 cost: 41.6744840616 time: 31.3375520706
...
done with epoch 10, epoch cost = 1107.1886208
(6780, 100)
(472, 100)
train acc = 0.753392330383, val acc = 0.23093220339
Micro Averaged:
0.23093220339
0.23093220339
0.23093220339
Macro Averaged:
0.166379310345
0.0846277494579
0.102853245095
----------------------------------------------------------------

epoch 25:
epoch: 25 batch: 0 cost: 24.8352216561 time: 26.5385270119
epoch: 25 batch: 1 cost: 25.7043667524 time: 28.1896729469
epoch: 25 batch: 2 cost: 28.6250381821 time: 29.2749710083
epoch: 25 batch: 3 cost: 24.5525269739 time: 28.1369180679
epoch: 25 batch: 4 cost: 31.5647038849 time: 26.661976099
epoch: 25 batch: 5 cost: 34.0491663823 time: 28.8919451237
epoch: 25 batch: 6 cost: 29.496201675 time: 29.6560571194
epoch: 25 batch: 7 cost: 32.3559821762 time: 26.1075680256
epoch: 25 batch: 8 cost: 39.3411230026 time: 29.0265541077
epoch: 25 batch: 9 cost: 38.2922740958 time: 28.4070789814
epoch: 25 batch: 10 cost: 32.4177628749 time: 29.248388052
...
-----------------------------------------------------------------

final answer:
...
done with epoch 29, epoch cost = 724.939926797
(6780, 100)
(472, 100)
train acc = 0.954572271386, val acc = 0.317796610169
Micro Averaged:
0.317796610169
0.317796610169
0.317796610169
Macro Averaged:
0.213874496258
0.116082327665
0.138908685799






****** Q5 b) python main.py --We mymodel --save word2vec_init_fixed.npz *******

epoch 0:
epoch: 0 batch: 0 cost: 104.822151876 time: 28.7583379745
epoch: 0 batch: 1 cost: 90.4673745776 time: 28.0306038857
epoch: 0 batch: 2 cost: 91.6982937313 time: 36.3578248024
epoch: 0 batch: 3 cost: 86.5400355103 time: 44.2572898865
epoch: 0 batch: 4 cost: 107.720844596 time: 29.6643819809
epoch: 0 batch: 5 cost: 105.158653955 time: 31.633877039
epoch: 0 batch: 6 cost: 104.168901592 time: 29.9445710182
epoch: 0 batch: 7 cost: 99.0045841876 time: 22.9396369457
epoch: 0 batch: 8 cost: 103.6685426 time: 37.1873970032
epoch: 0 batch: 9 cost: 99.9137292151 time: 48.0072770119
epoch: 0 batch: 10 cost: 93.2771924193 time: 49.5428080559
...
done with epoch 0, epoch cost = 2490.19177771
(6780, 100)
(472, 100)
train acc = 0.303687315634, val acc = 0.135593220339
Micro Averaged:
0.135593220339
0.135593220339
0.135593220339
Macro Averaged:
0.0992395731299
0.0565505020219
0.063638741417
----------------------------------------------------------------------

epoch 10:
epoch: 10 batch: 0 cost: 79.5826094753 time: 27.3299229145
epoch: 10 batch: 1 cost: 80.776558945 time: 29.1803710461
epoch: 10 batch: 2 cost: 82.5735022028 time: 30.7789027691
epoch: 10 batch: 3 cost: 77.9759437791 time: 29.196283102
epoch: 10 batch: 4 cost: 88.1020645326 time: 27.9248099327
epoch: 10 batch: 5 cost: 86.9255215526 time: 30.3232648373
epoch: 10 batch: 6 cost: 86.2840848751 time: 31.3809640408
epoch: 10 batch: 7 cost: 83.3856843248 time: 26.5959639549
epoch: 10 batch: 8 cost: 89.2490969906 time: 29.2280738354
epoch: 10 batch: 9 cost: 88.878557871 time: 28.7228507996
epoch: 10 batch: 10 cost: 84.7455191531 time: 33.7985179424
...
done with epoch 10, epoch cost = 2142.76974764
(6780, 100)
(472, 100)
train acc = 0.372271386431, val acc = 0.146186440678
Micro Averaged:
0.146186440678
0.146186440678
0.146186440678
Macro Averaged:
0.115655159791
0.0629706724197
0.0728311272061
-----------------------------------------------------------------------

epoch 25:
epoch: 25 batch: 0 cost: 74.0315145495 time: 27.0140240192
epoch: 25 batch: 1 cost: 78.271937289 time: 28.83345294
epoch: 25 batch: 2 cost: 79.5112453724 time: 29.8391780853
epoch: 25 batch: 3 cost: 75.8914379257 time: 28.8387229443
epoch: 25 batch: 4 cost: 84.0331750077 time: 27.2733781338
epoch: 25 batch: 5 cost: 82.429013705 time: 29.8506350517
epoch: 25 batch: 6 cost: 82.3341211247 time: 30.4090850353
epoch: 25 batch: 7 cost: 79.3167910225 time: 26.4621090889
epoch: 25 batch: 8 cost: 85.7138591896 time: 30.4335610867
epoch: 25 batch: 9 cost: 83.9968864923 time: 29.0504491329
epoch: 25 batch: 10 cost: 82.1858638233 time: 28.7175559998
...
-----------------------------------------------------------------------

final answer:
...
done with epoch 29, epoch cost = 1996.77111788
(6780, 100)
(472, 100)
train acc = 0.445722713864, val acc = 0.169491525424
Micro Averaged:
0.169491525424
0.169491525424
0.169491525424
Macro Averaged:
0.140323197552
0.0715074337696
0.0844263495197







********** Question 6: **********

The visualization is saved in file:
tsne_visualization.png


